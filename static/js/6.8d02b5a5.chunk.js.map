{"version":3,"sources":["pages/HomePage/useFetchDataHook.js","pages/HomePage/index.js","utils/axios.js"],"names":["STATUS","TYPE","reducer","state","action","type","status","data","payload","total","useFetchDataHook","keyword","useReducer","dispatch","useState","sourceToken","setSourceToken","value","a","trim","message","warning","cancel","CancelToken","axios","source","get","cancelToken","token","items","total_count","console","log","nextPage","Math","floor","length","HomePage","setKeyword","getData","getTotal","isLoading","isLoadSuccess","isLoadError","clearSearch","handleSearch","handleLoadMore","useEffect","document","title","className","style","width","Search","placeholder","enterButton","onSearch","onChange","e","target","icon","ClearOutlined","onClick","size","tip","spinning","delay","height","subTitle","map","user","index","key","id","borderBottom","src","avatar_url","login","href","html_url","to","instance","create","baseURL","isCancel"],"mappings":"mUAOMA,EACO,UADPA,EAEY,UAFZA,EAGU,QAGVC,EACI,OADJA,EAEY,eAFZA,EAGU,aAHVA,EAIiB,oBAGjBC,EAAU,SAACC,EAAOC,GACpB,OAAQA,EAAOC,MACX,KAAKJ,EACD,OAAO,eACAE,EADP,CAEIG,OAAQN,IAEhB,KAAKC,EACD,OAAO,eACAE,EADP,CAEIG,OAAQN,EACRO,KAAMH,EAAOI,QAAQD,KACrBE,MAAOL,EAAOI,QAAQC,QAE9B,KAAKR,EACD,OAAO,eACAE,EADP,CAEIG,OAAQN,IAEhB,KAAKC,EACD,OAAO,eACAE,EADP,CAEIG,OAAQN,EACRO,KAAK,GAAD,mBAAMJ,EAAMI,MAAZ,YAAqBH,EAAOI,QAAQD,OACxCE,MAAOL,EAAOI,QAAQC,QAE9B,QACI,OAAON,IAwGJO,EApGU,SAAAC,GAAY,IAAD,EAENC,qBAAWV,EAAS,CAC1CI,OAAQN,EACRO,KAAM,GACNE,MAAO,IALqB,mBAEzBN,EAFyB,KAElBU,EAFkB,OAOMC,mBAAS,MAPf,mBAOzBC,EAPyB,KAOZC,EAPY,iDAuChC,WAA4BC,GAA5B,qBAAAC,EAAA,kEAE6B,KAAjBD,EAAME,OAFlB,yCAGmBC,EAAA,EAAQC,QAAQ,wCAHnC,cAK4B,OAAhBN,GACAA,EAAYO,SAEhBT,EAAS,CAAER,KAAMJ,IACXsB,EAAcC,IAAMD,YACpBE,EAASF,EAAYE,SAC3BT,EAAeS,GAXvB,UAY+BD,IAAME,IAAN,0BAA6BT,GAAS,CACzDU,YAAaF,EAAOG,QAbhC,iBAYgBrB,EAZhB,EAYgBA,KAGRM,EAAS,CACLR,KAAMJ,EACNO,QAAS,CACLD,KAAMA,EAAKsB,MACXpB,MAAOF,EAAKuB,eAnB5B,kDAuBQC,QAAQC,IAAR,MACAnB,EAAS,CAAER,KAAMJ,IAxBzB,2DAvCgC,kEAmEhC,gCAAAiB,EAAA,kEAE+B,KAAnBP,EAAQQ,OAFpB,yCAGmBC,EAAA,EAAQC,QAAQ,sBAHnC,cAKcY,EAAWC,KAAKC,MAAMhC,EAAMI,KAAK6B,OAtH7B,IAsHuD,EACjEvB,EAAS,CAAER,KAAMJ,IANzB,SAO+BuB,IAAME,IAAN,0BAA6Bf,EAA7B,iBAA6CsB,IAP5E,gBAOgB1B,EAPhB,EAOgBA,KACRM,EAAS,CACLR,KAAMJ,EACNO,QAAS,CACLD,KAAMA,EAAKsB,MACXpB,MAAOF,EAAKuB,eAZ5B,kDAgBQC,QAAQC,IAAR,MACAnB,EAAS,CAAER,KAAMJ,IAjBzB,2DAnEgC,sBAwFhC,MAAO,CA/EP,WACI,OAAOE,EAAMI,MAGjB,WACI,OAAOJ,EAAMM,OAGjB,WACI,OAAON,EAAMG,SAAWN,GAG5B,WACI,OAAOG,EAAMG,SAAWN,GAG5B,WACI,OAAOG,EAAMG,SAAWN,GAG5B,WACIa,EAAS,CACLR,KAAMJ,EACNO,QAAS,CACLD,KAAM,GACNE,MAAO,MAlCa,yFCwDrB4B,UApGE,WAAO,IAAD,EAEWvB,mBAAS,IAFpB,mBAEZH,EAFY,KAEH2B,EAFG,OAYf5B,EAAiBC,GAZF,mBAIf4B,EAJe,KAKfC,EALe,KAMfC,EANe,KAOfC,EAPe,KAQfC,EARe,KASfC,EATe,KAUfC,EAVe,KAWfC,EAXe,KA4DnB,OA9CAC,qBAAU,WACNC,SAASC,MAAQ,SAClB,IA6CC,yBAAKC,UAAU,iEACX,yBAAKA,UAAU,yDAAyDC,MAAO,CAAEC,MAAO,MACpF,sBAAOC,OAAP,CACIC,YAAY,qBACZC,aAAW,EACXtC,MAAON,EACP6C,SAAUX,EACVY,SAlDhB,SAA2BC,GACvBpB,EAAWoB,EAAEC,OAAO1C,UAkDZ,uBACIiC,UAAU,OACVU,KAAM,kBAACC,EAAA,EAAD,MACNC,QAlDhB,WACIxB,EAAW,IACXM,MA6CQ,UAQJ,uBAAMmB,KAAK,QAAQC,IAAI,UAAUC,SAAUxB,IAAayB,MAAM,OAC1D,yBACIhB,UAAU,mEACVC,MAAO,CAAEC,MAAO,IAAKe,OAAQ,wBAE7B,uBAAGjB,UAAU,kBAAb,iBAA6CV,KAtDrDG,IACO,uBAAQrC,OAAO,MAAM2C,MAAM,MAAMmB,SAAS,iCAEjD1B,IACmB,IAAfF,IACmB,KAAZ7B,EAAiB,uBAAQsC,MAAM,uBAA0B,uBAAQA,MAAM,kBAEvEV,IAAU8B,KAAI,SAACC,EAAMC,GAAP,OACjB,yBAAKC,IAAKF,EAAKG,GAAIvB,UAAU,8CAA8CC,MAAO,CAAEuB,aAAc,mBAC9F,yBAAKxB,UAAU,qBACX,uBAAGA,UAAU,aAAb,IAA2BqB,EAAQ,GACnC,uBAAQI,IAAKL,EAAKM,WAAYb,KAAM,KACpC,yBAAKb,UAAU,QACX,uBAAGA,UAAU,4BACRoB,EAAKO,OAEV,uBAAGC,KAAMR,EAAKS,SAAUpB,OAAO,UAAUT,UAAU,qBAAnD,iBAKR,uBAAQ7C,KAAK,WACT,kBAAC,IAAD,CAAM2E,GAAE,kBAAaV,EAAKO,QAA1B,oBAnBpB,EAsDgBtC,IAAUH,OAASI,KAEf,yBAAKU,UAAU,kCACX,uBAAQ7C,KAAK,UAAUyD,QAAShB,GAAhC,mB,gCC/FhC,qBAEMmC,EAAWzD,IAAM0D,OAAO,CAC1BC,QAAS,2BAEbF,EAAS1D,YAAcC,IAAMD,YAC7B0D,EAASG,SAAW5D,IAAM4D,SAEXH","file":"static/js/6.8d02b5a5.chunk.js","sourcesContent":["import { useState, useReducer } from 'react';\nimport { message } from 'antd';\n\nimport axios from 'utils/axios';\n\nconst ITEM_PER_PAGE = 30;\n\nconst STATUS = {\n    LOADING: 'loading',\n    LOAD_SUCCESS: 'success',\n    LOAD_ERROR: 'error',\n}\n\nconst TYPE = {\n    LOAD: 'LOAD',\n    LOAD_SUCCESS: 'LOAD_SUCCESS',\n    LOAD_ERROR: 'LOAD_ERROR',\n    LOAD_MORE_SUCCESS: 'LOAD_MORE_SUCCESS',\n}\n\nconst reducer = (state, action) => {\n    switch (action.type) {\n        case TYPE.LOAD:\n            return {\n                ...state,\n                status: STATUS.LOADING\n            };\n        case TYPE.LOAD_SUCCESS:\n            return {\n                ...state,\n                status: STATUS.LOAD_SUCCESS,\n                data: action.payload.data,\n                total: action.payload.total,\n            }\n        case TYPE.LOAD_ERROR:\n            return {\n                ...state,\n                status: STATUS.LOAD_ERROR,\n            }\n        case TYPE.LOAD_MORE_SUCCESS:\n            return {\n                ...state,\n                status: STATUS.LOAD_SUCCESS,\n                data: [...state.data, ...action.payload.data],\n                total: action.payload.total,\n            }\n        default:\n            return state;\n    }\n}\n\nconst useFetchDataHook = keyword => {\n\n    const [state, dispatch] = useReducer(reducer, {\n        status: STATUS.LOAD_SUCCESS,\n        data: [],\n        total: 0\n    });\n    const [sourceToken, setSourceToken] = useState(null);\n\n    function getData() {\n        return state.data;\n    }\n\n    function getTotal() {\n        return state.total;\n    }\n\n    function isLoading() {\n        return state.status === STATUS.LOADING;\n    }\n\n    function isLoadSuccess() {\n        return state.status === STATUS.LOAD_SUCCESS;\n    }\n\n    function isLoadError() {\n        return state.status === STATUS.LOAD_ERROR;\n    }\n\n    function clearSearch() {\n        dispatch({\n            type: TYPE.LOAD_SUCCESS,\n            payload: {\n                data: [],\n                total: 0\n            }\n        });\n    }\n\n    async function handleSearch(value) {\n        try {\n            if (value.trim() === '') {\n                return message.warning('Please enter some keyword to search');\n            }\n            if (sourceToken !== null) {\n                sourceToken.cancel();\n            }\n            dispatch({ type: TYPE.LOAD });\n            const CancelToken = axios.CancelToken;\n            const source = CancelToken.source();\n            setSourceToken(source);\n            const { data } = await axios.get(`/search/users?q=${value}`, {\n                cancelToken: source.token\n            });\n            dispatch({\n                type: TYPE.LOAD_SUCCESS,\n                payload: {\n                    data: data.items,\n                    total: data.total_count\n                }\n            });\n        } catch (error) {\n            console.log(error);\n            dispatch({ type: TYPE.LOAD_ERROR });\n        }\n    }\n\n    async function handleLoadMore() {\n        try {\n            if (keyword.trim() === '') {\n                return message.warning('Keyword not found');\n            }\n            const nextPage = Math.floor(state.data.length / ITEM_PER_PAGE) + 1;\n            dispatch({ type: TYPE.LOAD });\n            const { data } = await axios.get(`/search/users?q=${keyword}&page=${nextPage}`);\n            dispatch({\n                type: TYPE.LOAD_MORE_SUCCESS,\n                payload: {\n                    data: data.items,\n                    total: data.total_count\n                }\n            });\n        } catch (error) {\n            console.log(error);\n            dispatch({ type: TYPE.LOAD_ERROR });\n        }\n    }\n\n    return [\n        getData,\n        getTotal,\n        isLoading,\n        isLoadSuccess,\n        isLoadError,\n        clearSearch,\n        handleSearch,\n        handleLoadMore\n    ];\n}\n\nexport default useFetchDataHook;\n","import React, { useState, useEffect } from 'react';\nimport { Link } from \"react-router-dom\";\nimport { Input, Avatar, Button, Spin, Result } from 'antd';\nimport { ClearOutlined } from '@ant-design/icons'\n\nimport useFetchDataHook from './useFetchDataHook'\n\nconst HomePage = () => {\n\n    const [keyword, setKeyword] = useState('');\n    const [\n        getData,\n        getTotal,\n        isLoading,\n        isLoadSuccess,\n        isLoadError,\n        clearSearch,\n        handleSearch,\n        handleLoadMore\n    ] = useFetchDataHook(keyword);\n\n    useEffect(() => {\n        document.title = 'Home'\n    }, []);\n\n    function handleInputChange(e) {\n        setKeyword(e.target.value)\n    }\n\n    function handleClearSearch() {\n        setKeyword('');\n        clearSearch();\n    }\n\n    function render() {\n        if (isLoadError()) {\n            return <Result status=\"500\" title=\"500\" subTitle=\"Sorry, something went wrong.\" />\n        }\n        if (isLoadSuccess()) {\n            if (getTotal() === 0) {\n                return keyword === '' ? <Result title=\"Enter some keyword\" /> : <Result title=\"No user found\" />\n            } else {\n                return getData().map((user, index) => (\n                    <div key={user.id} className=\"flex items-center mb-6 pb-6 justify-between\" style={{ borderBottom: '1px solid #ccc' }}>\n                        <div className=\"flex items-center\">\n                            <p className=\"mr-8 mb-0\">#{index + 1}</p>\n                            <Avatar src={user.avatar_url} size={48} />\n                            <div className=\"ml-4\">\n                                <p className=\"font-bold text-base mb-0\">\n                                    {user.login}\n                                </p>\n                                <a href={user.html_url} target=\"__blank\" className=\"text-sm underline\">\n                                    Github Link\n                                </a>\n                            </div>\n                        </div>\n                        <Button type=\"primary\">\n                            <Link to={`/detail/${user.login}`}>\n                                Detail\n                            </Link>\n                        </Button>\n                    </div>\n                ));\n            }\n        }\n    }\n\n    return (\n        <div className=\"container mx-auto pt-8 w-100 h-100 flex flex-col items-center\">\n            <div className=\"px-4 py-8 shadow-lg rounded flex items-center bg-white\" style={{ width: 600 }}>\n                <Input.Search\n                    placeholder=\"Search by username\"\n                    enterButton\n                    value={keyword}\n                    onSearch={handleSearch}\n                    onChange={handleInputChange} />\n                <Button\n                    className=\"ml-2\"\n                    icon={<ClearOutlined />}\n                    onClick={handleClearSearch}\n                >\n                    Clear\n                </Button>\n            </div>\n            <Spin size=\"large\" tip=\"Loading\" spinning={isLoading()} delay=\"200\">\n                <div\n                    className=\"mt-4 px-4 py-8 shadow-lg rounded overflow-y-auto scroll bg-white\"\n                    style={{ width: 600, height: 'calc(100vh - 170px)' }}\n                >\n                    <p className=\"font-bold mb-6\">Result found: {getTotal()}</p>\n                    {render()}\n                    {\n                        getData().length < getTotal()\n                        && (\n                            <div className=\"w-100 mt-4 flex justify-center\">\n                                <Button type=\"primary\" onClick={handleLoadMore}>\n                                    Load More\n                                </Button>\n                            </div>\n                        )\n                    }\n                </div>\n            </Spin>\n        </div>\n    );\n}\n\nexport default HomePage\n","import axios from 'axios';\n\nconst instance = axios.create({\n    baseURL: 'https://api.github.com'\n});\ninstance.CancelToken = axios.CancelToken;\ninstance.isCancel = axios.isCancel\n\nexport default instance;\n"],"sourceRoot":""}